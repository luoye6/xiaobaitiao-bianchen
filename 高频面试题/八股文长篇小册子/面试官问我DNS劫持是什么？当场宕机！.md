# 面试官问我DNS劫持是什么？当场宕机！

> 本文作者：[程序员小白条](https://github.com/luoye6)
>
> 本站地址：[https://xbt.xiaobaitiao.top](https://xbt.xiaobaitiao.top)

**面试官**：看你简历写了计算机网络的相关内容，我们来聊聊DNS安全吧。你知道什么是DNS劫持吗？

**我**：DNS 劫持？只听过 DNS 域名解析系统啊！

<img src="https://pic.yupi.icu/5563/202510291919110.png" style="zoom:25%;" />

## 解析答案

### DNS原理

DNS 劫持就是黑客劫持了 DNS 服务器，篡改了 DNS 解析的结果，将客户端请求的域名解析到错误的 IP 地址上面，从而导致客户端请求到错误的服务器，其经常发生在广告植入，钓鱼网站等场景。

![](https://pic.yupi.icu/5563/202510291908920.png)

我们访问网站的时候，首先会进行域名解析得到一个网站服务器的 IP 地址，然后进行后续的访问。DNS 劫持就是利用了这个漏洞，将我们原先请求的界面改成虚假网站的界面，这个时候我们访问的就是虚假网站的界面了。

### DNS劫持的攻击方式

主要罗列三种：DNS缓存投毒攻击、中间人攻击（MITM）、路由器DNS劫持（没错，小到你家里、寝室里的路由器.jpg)

#### 1. DNS缓存投毒攻击

攻击者向DNS服务器注入伪造的解析记录，利用服务器缓存机制扩大影响范围。这种攻击的特点是：

- **隐蔽性强**：用户难以察觉，因为请求确实发送到了DNS服务器
- **影响面广**：一个被污染的缓存会影响所有使用该服务器的用户
- **持续时间长**：直到缓存记录过期或被清除

#### 2. 中间人攻击（MITM）

在局域网环境中，攻击者通过ARP欺骗等技术将自己伪装成网关，截获并篡改DNS请求：

```Java
// 简化的DNS响应篡改逻辑
if (isTargetDomain(dnsRequest.getDomain())) {
    DnsResponse maliciousResponse = createFakeResponse(
        dnsRequest.getDomain(), 
        "恶意服务器IP"
    );
    sendToClient(maliciousResponse);
} else {
    // 转发正常响应避免被发现
    forwardLegitimateResponse(dnsRequest);
}
```

#### 3. 路由器DNS劫持

攻击者通过弱密码、漏洞利用等方式控制路由器，修改其DNS服务器设置：

- **利用默认凭证**：很多用户从未修改路由器的默认管理员密码
- **CSRF攻击**：通过恶意网页脚本修改路由器配置
- **恶意软件**：感染用户设备后自动修改网络设置

<img src="https://pic.yupi.icu/5563/202510291920841.png" style="zoom:25%;" />

### 应对 DNS 劫持的方法

1）直接通过 IP 地址访问网站，这个明显就不现实，你内网还可以考虑，互联网基本不可能。

2）由于域名解析一般都只能在特定的网络范围进行，所以可以访问一些正常的域名服务器完成目标网站的访问，比如说使用 8.8.8.8 作为 DNS 解析服务的首选服务器（这个谷歌的 DNS 服务器），如果这个都给黑了，那也没办法了，哈哈。

3）服务器端防护：使用权威DNS服务提供商，并且启用DNS查询日志记录，定期安全审计和漏洞扫描。

## 欢迎交流

本文主要介绍了DNS劫持是什么？DNS 劫持的核心原理以及相关的三种攻击方式，以及相关的防护措施，以下几个问题，欢迎在评论区留言分享！

1）如何区分DNS劫持和普通的网络连接问题？

2）在微服务架构中，如何保证服务发现的DNS安全？

3）未来DNS安全技术可能的发展方向是什么？
